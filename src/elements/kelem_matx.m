function [Kg] = kelem_matx(nelem, B, C, area, thick);

    Kg = zeros(36,nelem);
    Kg(1,:)  = (B(4,:).^2.*C(3,:) + B(1,:).^2.*C(1,:)).*area(:)'*thick;
    Kg(8,:)  = (B(1,:).^2.*C(3,:) + B(4,:).^2.*C(1,:)).*area(:)'*thick;
    Kg(15,:) = (B(5,:).^2.*C(3,:) + B(2,:).^2.*C(1,:)).*area(:)'*thick;
    Kg(29,:) = (B(6,:).^2.*C(3,:) + B(3,:).^2.*C(1,:)).*area(:)'*thick;
    Kg(22,:) = (B(2,:).^2.*C(3,:) + B(5,:).^2.*C(1,:)).*area(:)'*thick;
    Kg(36,:) = (B(3,:).^2.*C(3,:) + B(6,:).^2.*C(1,:)).*area(:)'*thick;

    Kg(2,:)  = (B(1,:).*B(4,:).*C(3,:) + B(1,:).*B(4,:).*C(2,:)).*area(:)'*thick;
    Kg(3,:)  = (B(4,:).*B(5,:).*C(3,:) + B(1,:).*B(2,:).*C(1,:)).*area(:)'*thick;
    Kg(4,:)  = (B(2,:).*B(4,:).*C(3,:) + B(1,:).*B(5,:).*C(2,:)).*area(:)'*thick;
    Kg(5,:)  = (B(4,:).*B(6,:).*C(3,:) + B(1,:).*B(3,:).*C(1,:)).*area(:)'*thick;
    Kg(6,:)  = (B(3,:).*B(4,:).*C(3,:) + B(1,:).*B(6,:).*C(2,:)).*area(:)'*thick;

    Kg(9,:)   = (B(1,:).*B(5,:).*C(3,:) + B(2,:).*B(4,:).*C(2,:)).*area(:)'*thick;
    Kg(10,:)  = (B(1,:).*B(2,:).*C(3,:) + B(4,:).*B(5,:).*C(1,:)).*area(:)'*thick;
    Kg(11,:)  = (B(1,:).*B(6,:).*C(3,:) + B(3,:).*B(4,:).*C(2,:)).*area(:)'*thick;
    Kg(12,:)  = (B(1,:).*B(3,:).*C(3,:) + B(4,:).*B(6,:).*C(1,:)).*area(:)'*thick;

    Kg(16,:)  = (B(2,:).*B(5,:).*C(3,:) + B(2,:).*B(5,:).*C(2,:)).*area(:)'*thick;
    Kg(17,:)  = (B(5,:).*B(6,:).*C(3,:) + B(2,:).*B(3,:).*C(1,:)).*area(:)'*thick;
    Kg(18,:)  = (B(3,:).*B(5,:).*C(3,:) + B(2,:).*B(6,:).*C(2,:)).*area(:)'*thick;

    Kg(23,:)  = (B(2,:).*B(6,:).*C(3,:) + B(3,:).*B(5,:).*C(2,:)).*area(:)'*thick;
    Kg(24,:)  = (B(2,:).*B(3,:).*C(3,:) + B(5,:).*B(6,:).*C(1,:)).*area(:)'*thick;

    Kg(30,:)  = (B(3,:).*B(6,:).*C(3,:) + B(3,:).*B(6,:).*C(2,:)).*area(:)'*thick;

    Kg([7 13 14 19 20 21 25 26 27 28 31 32 33 34 35],:) = ...
    Kg([2  3  9  4 10 16  5 11 17 23  6 12 18 24 30],:);

end
